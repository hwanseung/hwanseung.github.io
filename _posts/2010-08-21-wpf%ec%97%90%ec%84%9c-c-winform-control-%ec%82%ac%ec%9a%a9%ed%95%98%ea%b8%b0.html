---
layout: post
title: WPF에서 C# Winform Control 사용하기.
date: 2010-08-21 16:36:08.000000000 +09:00
type: post
published: true
status: publish
categories:
- Programing/WPF
tags:
- ".NET"
- c++
- directshow
- WinForm
- wpf
- 다이렉트쇼
meta:
  _thumbnail_id: '677'
author: Hwanseung Lee
---
<p>WPF에서 C# Winform Control 사용하는 법을 알아 보도록 하겠습니다. </p>
<div>

</div>
<div>
일단&nbsp;WPF에서 C# Winform Control를 쓰기위해서 두개를 참조를 해야 합니다.</div>
<div>

</div>
<div>
그 참조 해야 할것은&nbsp;</div>
<div>
<b>System.Windows.Forms</b>와</div>
<div>
<b>WindowsFormsIntegration</b>이라는 것을 참조해야됩니다.</div>
<div>

</div>
<div>
참조하는 방법은</div>
<div>
<img src="{{ site.baseurl }}/assets/cfile8.uf.1508020E4C6FFBF4990F75.png" class="aligncenter" width="307" height="140" alt="" filename="2.png" filemime="image/jpeg" /></div>
<div>
<div style="TEXT-ALIGN: left">
위의 그림과 같이 솔루션 탐색기에서 참조폴더에 오른쪽 마우스 버튼을 누르면 다음과 같이 띄게 되고 참조 추가를 선택합니다.</div>
<div style="TEXT-ALIGN: left">

</div>
<div style="TEXT-ALIGN: left">
수행하면 아래의 그림과 같이 창이 하나 뜹니다.</div>
<p><img src="{{ site.baseurl }}/assets/cfile29.uf.1308020E4C6FFBF49AD7C7.png" class="aligncenter" width="586" height="494" alt="" filename="3.png" filemime="image/jpeg" /></div>
<div>
.NET 탭에서 위의 그림과 같이&nbsp;System.Windows.Forms와&nbsp;WindowsFormsIntegration을 선택합니다.</div>
<div>

</div>
<div>
수행하면 참조에 두개가 추가된것을 알수 있습니다.</div>
<div>
<img src="{{ site.baseurl }}/assets/cfile4.uf.1408020E4C6FFBF49B8E24.png" class="aligncenter" width="285" height="366" alt="" filename="4.png" filemime="image/jpeg" /></div>
<div>

</div>
<div>
<span style="FONT-SIZE: 9pt">컨트롤을 넣을 window에 xaml코드를 수정합니다.</span></div>
<div>
<div>
<textarea class="xml" name="code">&lt;SPAN style="FONT-SIZE: 9pt"&gt; xmlns:winform="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms" &lt;/SPAN&gt;</textarea>
</div>
<div>
<font class="Apple-style-span" color="#000000" face="Consolas, 'Courier New', Courier, mono, serif"><span style="LINE-HEIGHT: 14px" class="Apple-style-span"><font class="Apple-style-span" color="#006699"><b><span style="LINE-HEIGHT: 18px; FONT-FAMILY: 굴림; COLOR: rgb(51,51,51); FONT-WEIGHT: normal" class="Apple-style-span"><br />
</span></b></font></span></font>
<div>
<span style="FONT-SIZE: 9pt">구문을 추가합니다. c#코드로는 using역활의 대신입니다.</span></div>
</div>
<div>

</div>
<div>
<textarea class="xml" name="code">&lt;SPAN style="FONT-SIZE: 9pt"&gt; &lt;WindowsFormsHost Margin="51,55,57,59" d:LayoutOverrides="GridBox" Width="80" Height="50" Background="White"&gt;<br />
            &lt;winform:Button Text="버튼" /&gt;<br />
        &lt;/WindowsFormsHost&gt;&lt;/SPAN&gt;</textarea></div>
<div>
<font class="Apple-style-span" color="#000000" size="3" face="monospace"><span style="LINE-HEIGHT: normal; WHITE-SPACE: pre-wrap; FONT-SIZE: 13px" class="Apple-style-span"><span style="FONT-SIZE: 9pt">버튼을 WindowsFormsHost에 추가하여 사용합니다.</span></span></font></div>
<div>
<font class="Apple-style-span" color="#000000" size="3" face="monospace"><span style="LINE-HEIGHT: normal; WHITE-SPACE: pre-wrap; FONT-SIZE: 13px" class="Apple-style-span"><span style="FONT-SIZE: 9pt">단. WindowsFormsHost에는 하나의 control밖에 사용하지 못합니다.</span></span></font></div>
<div>
<font class="Apple-style-span" color="#000000" size="3" face="monospace"><span style="LINE-HEIGHT: normal; WHITE-SPACE: pre-wrap; FONT-SIZE: 13px" class="Apple-style-span"><br />
</span></font></div>
<div>
<font class="Apple-style-span" color="#000000" size="3" face="monospace"><span style="LINE-HEIGHT: normal; WHITE-SPACE: pre-wrap; FONT-SIZE: 13px" class="Apple-style-span"><br />
</span></font></div>
<div>
<font class="Apple-style-span" color="#000000" size="3" face="monospace"><span style="LINE-HEIGHT: normal; WHITE-SPACE: pre-wrap; FONT-SIZE: 13px" class="Apple-style-span"><span style="FONT-SIZE: 9pt">전체 xaml소스를 보면 다음과 같습니다.</span></span></font></div>
<div>
<font class="Apple-style-span" color="#000000" size="3" face="monospace"><span style="LINE-HEIGHT: normal; WHITE-SPACE: pre-wrap; FONT-SIZE: 13px" class="Apple-style-span"><span style="LINE-HEIGHT: 18px; FONT-FAMILY: 굴림; WHITE-SPACE: normal; COLOR: rgb(51,51,51); FONT-SIZE: 12px" class="Apple-style-span"><textarea class="xml" name="code">&lt;SPAN style="FONT-SIZE: 9pt"&gt;&lt;Window<br />
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"<br />
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"<br />
        xmlns:winform="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"<br />
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d" x:Class="BringOnAir.dsDotNetTest"<br />
        Title="dsDotNetTest" Height="200" Width="200         "&gt;<br />
    &lt;Grid Background="Black"&gt;</p>
<p>        &lt;WindowsFormsHost Margin="51,55,57,59" d:LayoutOverrides="GridBox" Width="80" Height="50" Background="White"&gt;<br />
            &lt;winform:Button Text="버튼" /&gt;<br />
        &lt;/WindowsFormsHost&gt;</p>
<p>    &lt;/Grid&gt;<br />
&lt;/Window&gt;<br />
&lt;/SPAN&gt;</textarea></span></span></font></div>
<div>
<font class="Apple-style-span" color="#000000" size="3" face="monospace"><span style="LINE-HEIGHT: normal; WHITE-SPACE: pre-wrap; FONT-SIZE: 13px" class="Apple-style-span"><br />
</span></font></div>
</div>
<p><span style="FONT-SIZE: 9pt">빌드를 시켜 실행시켜보면 </span></p>
<div>
짜짠~~! </p>
<div>
<img src="{{ site.baseurl }}/assets/cfile24.uf.1508020E4C6FFBF49C2D37.png" class="aligncenter" width="215" height="209" alt="" filename="5.png" filemime="image/jpeg" />
</div>
</div>
<div>
WPF에 winform 버튼이 뜨게 되었습니다.</div>
<div>

</div>
<div>
활용방안은 많겠죠;</div>
<div>
저는 일단 이번 프로젝트에 direct show를 사용하여 동영상플레이 화면을 WPF에서 올릴 생각입니다.</div>
<div>
.net에서&nbsp;direct show를&nbsp;사용할 수 있는 directshow.net이라는 라이브러리가 있는데 c# Winform의 panel를 이용하여</div>
<div>
동영상화면을 띄우더라구요 ㅋ</div>
<div>

</div>
